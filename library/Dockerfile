FROM node:18.12-alpine

WORKDIR /app

# nodemon все равно установился в package-lock, странно
# не, все ок, в нодемодулес он не встал, а пакадж-лок копируется в контейнер уже готовый
# Нодемон не взлетит, пока закомментирую, а в идеале 2 разных докер композа
# ARG NODE_ENV=production

COPY package*.json ./
COPY src/ ./

# Наверное такое себе решение, но еще вчера он не ругался, что вышла новая версия нпм
# RUN npm install -g npm@8.19.3
RUN npm i

EXPOSE 3002

# Этот скрипт содержит в себе запуск через nodemon с флагом -L - это одна из составляющих разработки без пересборки контейнера
CMD [ "npm", "run", "dev" ]
